{
  "ID":"${node = location.pathname.get(4)}",
  "Node":"${node}",
  "Address":"${ip = fake.internet.ip()}",
  "TaggedAddresses":{"lan":"${ip}","wan":"${ip}"},
  "Meta":{
    "consul-network-segment":""
  },
  "Services":[
    ${
      range(
        env(
          'CONSUL_SERVICE_COUNT',
          Math.floor(
            (
              Math.random() * env('CONSUL_SERVICE_MAX', 10)
            ) + parseInt(env('CONSUL_SERVICE_MIN', 1))
          )
        )
      ).map(
        function(item, i)
        {
          const service = `service-${i}`;
          return `
            {
              "ID": "${ i === 0 ? 'service-0-with-id' : fake.helpers.randomize([service, service + '-ID'])}",
              "Service":"${service}",
              "Tags":[
                ${
                  range(
                    env(
                      'CONSUL_TAG_COUNT',
                      Math.floor(
                        (
                          Math.random() * env('CONSUL_TAG_MAX', 10)
                        ) + parseInt(env('CONSUL_TAG_MIN', 1))
                      )
                    )
                  ).map(
                    function(item, i)
                    {
                      return `"${fake.hacker.noun()}"`;
                    }
                  )
                }
              ],
${ fake.random.number({min: 1, max: 10}) > 2 ? `
            "Meta": {
              "external-source": "${fake.helpers.randomize(['consul', 'nomad', 'terraform', 'kubernetes', ''])}"
            },
` : `` }
              "Address":"",
              "Port": ${ i === 0 ? '65535' : fake.random.number({min: 0, max: 65534})},
              "EnableTagOverride":false,
              "CreateIndex":11,
              "ModifyIndex":11
            }
          `;
        }
      )
    }
  ],
  "Checks":[
    ${
      range(env('CONSUL_CHECK_COUNT', 3)).map(
        function(item, i)
        {
          return `
            {
              "Node":"${location.pathname.get(4)}",
              "CheckID":"Disk Util",
              "Name":"Disk Util",
              "Status":"${fake.helpers.randomize(['passing', 'warning', 'critical'])}",
              "Notes":"Critical 5%, warning 10% free",
              "Output":"DISK OK - free space: / 17364 MB (90% inode=93%);| /=1806MB;18013;19014;0;20015",
              "ServiceID":"",
              "ServiceName":"",
              "ServiceTags":null,
              "Definition":{},
              "CreateIndex":12,
              "ModifyIndex":230113
            }
          `;
        }
      )
    }
   ]
}
